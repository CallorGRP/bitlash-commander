<!DOCTYPE html>
<!-- Copyright 2012 by Bill Roy - MIT license - See LICENSE file -->
<html><head>
	<title>Bitlash Commander</title>
	<script type='text/javascript' src='js/jquery-1.8.2.min.js'></script>
	<script type='text/javascript' src='/js/fastclick.js'></script>
	<script type='text/javascript' src='/js/raphael.js'></script>
	<script type='text/javascript' src='/js/d3.v2.min.js'></script>
	<script type='text/javascript' src='js/mustache.js'></script>
	<script type='text/javascript' src='/socket.io/socket.io.js'></script>
	<script type='text/javascript' src='/js/svg-controls.js'></script>
	<script type='text/javascript' src='/js/sound.js'></script>
	<script type='text/javascript' src='/js/jplayer/jquery.jplayer.min.js'></script>
</head><body style='background:gray'>

<script type='text/javascript' charset='utf8'>

$(document).ready(function() {

	document.ontouchmove = function(e) {e.preventDefault()};	// stop bounce scrolling on iPad

	// open a Panel with a channel specifier ('panic') to segregate update traffic
	var Panel = new ControlPanel({title: "Don't Panic!", color: 'white', channel:'panic'});

	Panel.addButton({
		id: 'panic',
		x: Panel.x + Panel.w/2, 
		y: Panel.y + Panel.h/2,
		text: 'PANIC',
		shape: 'circle',
		r: Panel.h/3, 
		fontsize: 36,
		//script: 'r=!r; if r print "RED ALERT"; else print "ALL CLEAR";'
		script: 'javascript: if (this.value=="RED ALERT") this.setValue("ALL CLEAR"); else this.setValue("RED ALERT");'
	});

	var panicbutton = Panel.controls['panic.panic'];	// mind the channel.control syntax
	panicbutton.on('update', function(data) {
		var color;
		if (data.value == 'RED ALERT') {
			color = 'red';
			Sound.play('klaxon');
		}
		else {
			color = panicbutton.parent.fill;
			Sound.play('gong');
		}
		panicbutton.attr({fill: color});
		//Panel.attr({fill: color});
	});
		
}); 	// document.ready
</script>
<div id='player'></div>
</body></html>
